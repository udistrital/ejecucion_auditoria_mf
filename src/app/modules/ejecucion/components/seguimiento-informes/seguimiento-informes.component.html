<plantilla-tarjeta-contenedora
  [title]="''"
  [breadcrumb]="
    '<p>Gestión Auditoría / Ejecución / <b>Auditorías Internas</b></p>'
  "
  [contenido]="contenidoDePlantilla"
></plantilla-tarjeta-contenedora>

<ng-template #contenidoDePlantilla>
  <div class="row mt-3">
    <div class="col-12">
      <div class="section">
        <div class="filter-section">
          <mat-form-field appearance="outline">
            <mat-label>Seleccione el año del plan:</mat-label>
            <mat-icon color="primary" matPrefix>today</mat-icon>
            <mat-select id="ano-select" [(value)]="selectedYearId">
              <mat-option *ngFor="let year of years" [value]="year.Id">
                {{ year.Nombre }}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <button
            mat-raised-button
            color="primary"
            class="mx-3"
          >
            Crear
          </button>
        </div>
        <p>Seleccione el año de las auditorias</p>
      </div>

      <div class="row mt-3">
        <div class="col-12">
          <h3 class="my-3">Lista auditorías</h3>
          <p>
            Seleccione la auditoría interna a realizar y/o evaluación
          </p>

          <div class="table-container">
            <table mat-table [dataSource]="dataSource" class="mt-3">
              <!-- No Column -->
              <ng-container matColumnDef="no">
                <th mat-header-cell *matHeaderCellDef class="header">
                  <b>No.</b>
                </th>
                <td
                  mat-cell
                  *matCellDef="let element; let i = index"
                  class="cell"
                >
                  {{ i + 1 + offset }}
                </td>
              </ng-container>

              <!-- Vigencia Column -->
              <ng-container matColumnDef="vigencia">
                <th mat-header-cell *matHeaderCellDef class="header">
                  <b>Vigencia</b>
                </th>
                <td mat-cell *matCellDef="let element" class="cell">
                  {{ element.vigencia }}
                </td>
              </ng-container>

              <!-- Auditoria -->
              <ng-container matColumnDef="auditoria">
                <th mat-header-cell *matHeaderCellDef class="header">
                  <b>Auditoría</b>
                </th>
                <td mat-cell *matCellDef="let element" class="cell">
                  {{ element.auditoria }}
                </td>
              </ng-container>

              <!-- Auditor Column -->
              <ng-container matColumnDef="auditor">
                <th mat-header-cell *matHeaderCellDef class="header">
                  <b>Auditor (es)</b>
                </th>
                <td mat-cell *matCellDef="let element" class="cell">
                  {{ element.creadoPor }}
                </td>
              </ng-container>

              <!-- Dependencia Column -->
              <ng-container matColumnDef="dependencia">
                <th mat-header-cell *matHeaderCellDef class="header">
                  <b>Dependencia</b>
                </th>
                <td mat-cell *matCellDef="let element" class="cell">
                  {{ element.dependencia ?? 'Sin asignar' }}
                </td>
              </ng-container>

              <!-- Líder Column -->
              <ng-container matColumnDef="lider">
                <th mat-header-cell *matHeaderCellDef class="header">
                  <b>Líder</b>
                </th>
                <td mat-cell *matCellDef="let element" class="cell">
                  {{ element.lider ?? 'Sin asignar' }}
                </td>
              </ng-container>

              <!-- Responsable Column -->
              <ng-container matColumnDef="responsable">
                <th mat-header-cell *matHeaderCellDef class="header">
                  <b>Responsable</b>
                </th>
                <td mat-cell *matCellDef="let element" class="cell">
                  {{ element.responsable ?? 'Sin asignar' }}
                </td>
              </ng-container>

              <!-- Estado Column -->
              <ng-container matColumnDef="estado">
                <th mat-header-cell *matHeaderCellDef class="header">
                  <b>Estado</b>
                </th>
                <td mat-cell *matCellDef="let element" class="cell">
                  {{ element.estado }}
                </td>
              </ng-container>

              <!-- Estado Column -->
              <ng-container matColumnDef="documentos">
                <th mat-header-cell *matHeaderCellDef class="header">
                  <b>Documentos</b>
                </th>
                <td mat-cell *matCellDef="let element" class="cell">
                  {{ element.documentos }}
                </td>
              </ng-container>

              <!-- Acciones Column -->
              <ng-container matColumnDef="acciones">
                <th mat-header-cell *matHeaderCellDef class="header">
                  <b>Acciones</b>
                </th>
                <td mat-cell *matCellDef="let element" class="cell">
                  <button mat-icon-button [matMenuTriggerFor]="menu">
                    <mat-icon>more_vert</mat-icon>
                  </button>
                  <mat-menu #menu="matMenu">
                    <button mat-menu-item (click)="editarInforme(element)">
                      <mat-icon color="primary">edit</mat-icon>
                      Editar Informe
                    </button>
                    <button mat-menu-item (click)="enviarAprobacion(element)">
                      <mat-icon color="primary">send</mat-icon>
                      Enviar Aprobación Jefe OCI
                    </button>
                  </mat-menu>
                </td>
              </ng-container>

              <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
            </table>
          </div>
          <mat-paginator
            [pageSizeOptions]="opcionesPagina"
            [length]="total"
            showFirstLastButtons
          ></mat-paginator>
        </div>
      </div>
      
    </div>
  </div>
</ng-template>
